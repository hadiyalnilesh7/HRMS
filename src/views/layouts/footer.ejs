  </div> <!-- End of .main-content -->
  
  <%- include("./popup") %>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // Mobile sidebar toggle functionality
  const toggleButton = document.getElementById('sidebar-toggle');
  const closeButton = document.getElementById('sidebar-toggle-close');
  const sidebar = document.querySelector('.sidebar');
  const sidebarOverlay = document.getElementById('sidebar-overlay');
  const sidebarLinks = document.querySelectorAll('.sidebar .nav-link, .sidebar-footer .nav-link');

  function hideSidebar() {
    if (sidebar) {
      sidebar.classList.remove('sidebar-mobile-open');
      document.body.classList.remove('sidebar-open');
    }
    if (sidebarOverlay) {
      sidebarOverlay.classList.remove('sidebar-overlay-visible');
    }
  }

  function showSidebar() {
    if (sidebar) {
      sidebar.classList.add('sidebar-mobile-open');
      document.body.classList.add('sidebar-open');
    }
    if (sidebarOverlay) {
      sidebarOverlay.classList.add('sidebar-overlay-visible');
    }
  }

  // Toggle sidebar on button click
  if (toggleButton) {
    toggleButton.addEventListener('click', (e) => {
      e.stopPropagation();
      if (sidebar && sidebar.classList.contains('sidebar-mobile-open')) {
        hideSidebar();
      } else {
        showSidebar();
      }
    });
  }

  // Close sidebar on close button click
  if (closeButton) {
    closeButton.addEventListener('click', (e) => {
      e.stopPropagation();
      hideSidebar();
    });
  }

  // Close sidebar when a link is clicked
  sidebarLinks.forEach(link => {
    link.addEventListener('click', (e) => {
      // Only close if it's not a function (like logout with confirm)
      setTimeout(() => {
        hideSidebar();
      }, 100);
    });
  });

  // Close sidebar when overlay is clicked
  if (sidebarOverlay) {
    sidebarOverlay.addEventListener('click', () => {
      hideSidebar();
    });
  }

  // Close sidebar when clicking outside
  document.addEventListener('click', (e) => {
    if (sidebar && sidebar.classList.contains('sidebar-mobile-open')) {
      if (!sidebar.contains(e.target) && e.target !== toggleButton && !toggleButton.contains(e.target)) {
        hideSidebar();
      }
    }
  });
</script>
    
</body>
</html>